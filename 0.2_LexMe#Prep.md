Tutorial
https://www.youtube.com/watch?v=Q4rXmxQ1AUM&t=269s

App-Source:
https://github.com/pixegami/task-app

Preperations:
-------------
----------
# Supabase CLI (installieren):
supabase init
supabase link --project-ref $PROJECT_REF

Supabase-Linktest:
supabase projects list

----------
# Google
console.cloud.google -> credentials -> API Services
Add:
-> Webapplication

- Authorised Javascript origins
https://[PROJECT_ID].supabase.co
https://localhost
http://localhost

- Authorised redirect URIs
https://[PROJECT_ID].supabase.co/auth/v1/callback

-----------
# Stripe (installieren):
```stripe login```

(Lookup in Readme for commands)
- Create a product
- Create billing portal configuration (replace urls with own supabase.co)
- Ceate Webhook Endpoint  (Stripe Portal)

----------
# Set Supabase projects:
supabase secrets set STRIPE_SECRET_KEY=sk_test_xxx
supabase secrets set STRIPE_PRICE_ID=price_xxx
supabase secrets set STRIPE_WEBHOOK_SECRET=whsec_xxx

# Supase-Secret-Test:
supabase secrets list

(in Supabase - SQL Editor)
# Create SQL Snippet (sk_test_xxx = secret_key):
```sql
insert into vault.secrets (name, secret)
    values ('stripe', 'your-stripe-secret-key')
    returning key_id;
```
    *If you need to update it later, use:*
```sql
update vault.secrets
    set secret = 'your-new-stripe-secret-key'
    where name = 'stripe'
    returning key_id;
```
------
# Apply DB migrations (in Supabase CLI)
```supabase db push```
*- Reset and re-run everything
```
supabase db reset --linked
```
------
*- For API Operations (automatically created by Supabase as default(Rest API Documention))
const { data, error } = await supabase
  .from ("tasks")
  .insert({ title, description })
  .select();
---------
---------
- Run Docker (for Deployment)
# Deploy edge functions (Supabase CLI)
supabase functions deploy create-task-with-ai
supabase functions deploy create-stripe-session
supabase functions deploy stripe-webhook

# Stripe Restrictions (Supabase Portal Settings)
- Disable JWT Enforce Verification in (Supabase -> Edge Functions -> stripe-webhook)
---------
Terminal:

cd supabase

supabase start
(startet die lokalen Supabase-Dienste, einschlieÃŸlich der Postgres-Datenbank, mit Docker.)

supabase migration up
(Wende die Datenbank-Migrationen an: Dieser Schritt ist entscheidend, da er die Datenbankstruktur (Tabellen, Spalten, etc.) erstellt, die die Anwendung benÃ¶tigt.)

--------
# Starte App (Terminal):
```npm run dev```
---------
# Test App:
```npm test```
--------
# Run specific test file
```npm test tests/integration/2_auth.test.ts```
